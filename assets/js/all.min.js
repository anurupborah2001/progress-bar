var endpointURL="http://pb-api.herokuapp.com/bars",loadingDiv=document.getElementById("loading"),btnTemplateId=document.getElementById("buttonTmpl").innerHTML,progressTmpl=document.getElementById("progressbarTmpl").innerHTML,selectTmpl=document.getElementById("selectTmpl").innerHTML,btnPlaceholder=document.getElementById("btn-placeholder"),barPlaceholder=document.getElementById("bar-placeholder"),selectPlaceholder=document.getElementById("select-placeholder"),selectedOption="",http_get="GET",http_post="POST",selectLimit=100,progress_green="#4CAF50",progress_orange="#F80",progress_red="#FF0000",JsonParser={manipulate:function(e,t){var n=[];for(var r in e)n.push({index:r,elem:e[r]});var o={};return o[t]=n,o}},LoadButtons={load:function(e){var t=JsonParser.manipulate(e,"btnitem");this.render(t)},render:function(e){var t=Mustache.render(btnTemplateId,e);btnPlaceholder.innerHTML=t}},LoadSelect={load:function(e){var t=Mustache.render(selectTmpl,e);selectPlaceholder.innerHTML=t}},LoadBars={load:function(e){var t=JsonParser.manipulate(e,"barprogressitem");this.render(t)},render:function(e){var t=Mustache.render(progressTmpl,e);barPlaceholder.innerHTML=t,LoadSelect.load(e)},animate:function(e,t){e=e>0?e:0,t.dataset.progress=e,t.style.width=e+"%",t.nextElementSibling.innerHTML=e+"%"},renderOnClick:function(e,t){var n=document.getElementById("progessbarId"+e),r=n.dataset.progress,o=parseInt(r)+parseInt(t);setInterval(this.animate(o,n),10);var a=Loadlimit.renderColorLimit(o);n.style.backgroundColor=a.color}},Loadlimit={init:function(e){selectLimit=parseInt(e)},renderColorLimit:function(e){var t=selectLimit-50>0?selectLimit-50:0;return e>t&&e<selectLimit?{color:progress_orange}:selectLimit>t&&e>t?{color:progress_red}:{color:progress_green}}},ajaxRequest={beforeSend:function(){loadingDiv.style.display="block"},getJSON:function(e,t,n){var r=new XMLHttpRequest;r.open(n,e,!0),r.responseType="json",r.onload=function(){var e=r.status;200===e?t(null,r.response):t(e,r.response)},r.send()},afterSend:function(){loadingDiv.style.display="none"}},progress={init:function(e){var t=document.getElementById("progress-select");selectedOption=t.options[t.selectedIndex],this.renderProgress(e)},renderProgress:function(e){var t=selectedOption.dataset.item;LoadBars.renderOnClick(t,e)}},loadEndpoint={init:function(){ajaxRequest.beforeSend(),ajaxRequest.getJSON(endpointURL,function(e,t){if(null!=e)return alert("Data cannot be fetched"),!1;void 0!==t.buttons&&LoadButtons.load(t.buttons),void 0!==t.bars&&LoadBars.load(t.bars),void 0!==t.limit&&Loadlimit.init(t.limit),ajaxRequest.afterSend()},http_get)}};loadEndpoint.init();